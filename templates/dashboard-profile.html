{% extends 'dashboard_base.html' %}
{% load static %}

{% block title %}User Profile{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard-profile.css' %}">
{% endblock %}

{% block content %}
<div class="header">
    <button class="hamburger" id="hamburger">
        <i class="fas fa-bars"></i>
    </button>
    <h1 class="page-title">My Profile</h1>
    <div class="action-buttons">
        <button type="button" class="btn" id="toggleEditBtn"><i class="fas fa-edit"></i> Edit Profile</button>
    </div>
</div>

<!-- Main Content Area -->
<div class="profile-layout">
    <!-- Profile Card -->
    <div class="profile-card">
        <div class="cover-photo"></div>
        <div class="profile-info">
            <div class="large-profile-pic">
                <img src="{{ user.profile_img.url|default:'/media/default_pf.png' }}" alt="Profile"
                    class="avatar-large">
            </div>
            <h2>{{ user.first_name }} {{ user.last_name }}</h2>
            <p class="role">Student</p> <!-- Dynamic role if available -->
            <p class="location"><i class="fas fa-map-marker-alt"></i> {{ user.location|default:"Location not set" }}</p>

            <div class="stats">
                <div class="stat-item">
                    <span class="count">250</span>
                    <span class="label">Connections</span>
                </div>
                <div class="stat-item">
                    <span class="count">12</span>
                    <span class="label">Events</span>
                </div>
                <div class="stat-item">
                    <span class="count">5</span>
                    <span class="label">Projects</span>
                </div>
            </div>

            <div class="social-links">
                <a href="{{ user.linkedin_url|default:'#' }}" class="social-btn"><i class="fab fa-linkedin-in"></i></a>
                <a href="{{ user.github_url|default:'#' }}" class="social-btn"><i class="fab fa-github"></i></a>
                <a href="mailto:{{ user.email }}" class="social-btn"><i class="fas fa-envelope"></i></a>
            </div>
        </div>
    </div>

    <!-- Personal Details Section -->
    <div class="profile-form-section">
        <div class="section-header">
            <h2 class="section-title">Personal Details</h2>
        </div>

        <form id="profileForm" method="post" enctype="multipart/form-data" action="{% url 'dashboard-profile' %}">
            {% csrf_token %}
            <div class="profile-details">
                <!-- Profile Image Upload (Hidden by default or part of edit flow) -->
                <div class="form-group full-width image-upload-group" style="display:none;">
                    <label>Profile Image</label>
                    <input type="file" name="profile_img" class="edit-input">
                </div>

                <div class="form-group">
                    <label>Full Name</label>
                    <div class="value">{{ user.first_name }} {{ user.last_name }}</div>
                    <input type="text" name="full_name" class="edit-input"
                        value="{{ user.first_name }} {{ user.last_name }}" style="display:none;">
                </div>

                <div class="form-group">
                    <label>Email</label>
                    <div class="value">{{ user.email }}</div>
                    <input type="email" name="email" class="edit-input" value="{{ user.email }}" style="display:none;">
                </div>

                <div class="form-group">
                    <label>Phone</label>
                    <div class="value">{{ user.phone_number }}</div>
                    <input type="text" name="phone_number" class="edit-input" value="{{ user.phone_number }}"
                        style="display:none;">
                </div>

                <div class="form-group">
                    <label>University</label>
                    <div class="value">{{ user.university }}</div>
                    <input type="text" name="university" class="edit-input" value="{{ user.university }}"
                        style="display:none;">
                </div>

                <div class="form-group">
                    <label>Course</label>
                    <div class="value">{{ user.course }}</div>
                    <input type="text" name="course" class="edit-input" value="{{ user.course }}" style="display:none;">
                </div>

                <div class="form-group">
                    <label>Passing Year</label>
                    <div class="value">{{ user.passing_year }}</div>
                    <input type="text" name="passing_year" class="edit-input" value="{{ user.passing_year }}"
                        style="display:none;">
                </div>

                <div class="form-group">
                    <label>Current Company</label>
                    <div class="value">{{ user.current_company }}</div>
                    <input type="text" name="current_company" class="edit-input" value="{{ user.current_company }}"
                        style="display:none;">
                </div>

                <div class="form-group">
                    <label>Position</label>
                    <div class="value">{{ user.current_position }}</div>
                    <input type="text" name="current_position" class="edit-input" value="{{ user.current_position }}"
                        style="display:none;">
                </div>

                <div class="form-group full-width">
                    <label>About Me</label>
                    <div class="value">{{ user.bio }}</div>
                    <textarea name="bio" class="edit-input" style="display:none;">{{ user.bio }}</textarea>
                </div>

                <div class="form-group">
                    <label>Location</label>
                    <div class="value">{{ user.location }}</div>
                    <input type="text" name="location" class="edit-input" value="{{ user.location }}"
                        style="display:none;">
                </div>

                <div class="form-group full-width" id="saveContainer" style="display:none;">
                    <button type="submit" class="btn btn-save">Save Changes</button>
                    <button type="button" class="btn btn-cancel" id="cancelEditBtn">Cancel</button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Edit Profile Modal (Alternative if implemented via modal as suggested by css, but checking html structure showed form toggle) -->
<!-- Keeping existing structure: Form toggle seems to be the logic based on JS -->

{% endblock %}

{% block extra_js %}
<script src="{% static 'js/dashboard-profile.js' %}"></script>
{% endblock %}